<!DOCTYPE html>
<html>
    <head>
        <title>Danodarda AR Navigation</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    </head>
    <body style="margin: 0; overflow: hidden">
        <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
            <a-camera gps-camera rotation-reader></a-camera>
        </a-scene>

        <script>
            const scene = document.querySelector("a-scene");

            // Example start and end points in Danodarda
            const start = [72.251989, 23.663828]; // [lon, lat]
            const end = [72.2525, 23.6642]; // [lon, lat]

            // OSRM API for walking directions
            const osrmUrl = `https://router.project-osrm.org/route/v1/foot/${start[0]},${start[1]};${end[0]},${end[1]}?overview=full&geometries=geojson&steps=true`;

            fetch(osrmUrl)
                .then((res) => res.json())
                .then((data) => {
                    const steps = data.routes[0].legs[0].steps;

                    steps.forEach((step, index) => {
                        const [lon, lat] = step.maneuver.location;

                        // Create 3D arrow entity
                        const arrow = document.createElement("a-box");
                        arrow.setAttribute("color", "#FF0000");
                        arrow.setAttribute("depth", "2");
                        arrow.setAttribute("height", "2");
                        arrow.setAttribute("width", "2");
                        arrow.setAttribute(
                            "gps-entity-place",
                            `latitude: ${lat}; longitude: ${lon}`
                        );
                        arrow.setAttribute("look-at", "[gps-camera]");
                        arrow.setAttribute(
                            "rotation",
                            `0 ${
                                step.maneuver.bearing_after -
                                step.maneuver.bearing_before
                            } 0`
                        );
                        scene.appendChild(arrow);

                        // Optional: add text label
                        const label = document.createElement("a-text");
                        label.setAttribute("value", step.maneuver.instruction);
                        label.setAttribute("color", "#FFFF00");
                        label.setAttribute("scale", "10 10 10");
                        label.setAttribute(
                            "gps-entity-place",
                            `latitude: ${lat}; longitude: ${lon}`
                        );
                        label.setAttribute("look-at", "[gps-camera]");
                        label.setAttribute("position", "0 5 0");
                        scene.appendChild(label);
                    });
                })
                .catch((err) => console.error(err));
        </script>
    </body>
</html>
